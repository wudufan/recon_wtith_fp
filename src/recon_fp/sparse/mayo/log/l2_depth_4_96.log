2022-04-23 04:15:47.676707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
./config/l2_depth_4.cfg
[DEFAULT]

[IO]
x_dir = mayo/data/96
y_dir = mayo/data/2304
output_dir = mayo/train/
postfix = .nii.gz
train = None
valid = ['L291', 'L143', 'L067', 'ACR']
tag = 96/l2_depth_4
checkpoint = None

[Train]
device = 3
lr = [0.0001, 3e-05, 1e-05]
epochs = [50, 100, 200]
save_freq = 20
batch_size = 8
relog = 1
seed = 0

[Data]
norm = 1000
offset = -1
flip = 1
verbose = 2

[Network]
input_shape = (640, 640, 1)
output_channel = 1
nconv_per_module = 2
down_features = (32, 64, 128, 256)
bottleneck_features = 512
up_features = None
strides = (2, 2, 2, 2)
use_adding = 0
use_bn = 0
use_bilinear_upsampling = 0
dropout_rate = 0.0
use_relu_output = 0
lrelu = 0.2
use_residual = 1

[Display]
islice = 95
norm_x = 1000
vmin_x = -160
vmax_x = 240
norm_y = 1000
vmin_y = -160
vmax_y = 240

Setting up model
2022-04-23 04:15:49.099112: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-04-23 04:15:49.099951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2022-04-23 04:15:49.227086: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-04-23 04:15:49.229005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:13:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 836.37GiB/s
2022-04-23 04:15:49.229038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2022-04-23 04:15:49.230726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2022-04-23 04:15:49.230794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2022-04-23 04:15:49.232339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-04-23 04:15:49.232618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-04-23 04:15:49.234365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2022-04-23 04:15:49.235414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2022-04-23 04:15:49.239410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2022-04-23 04:15:49.239541: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-04-23 04:15:49.251564: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-04-23 04:15:49.253340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2022-04-23 04:15:49.253590: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-04-23 04:15:49.258439: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-04-23 04:15:49.260519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:13:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 836.37GiB/s
2022-04-23 04:15:49.260557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2022-04-23 04:15:49.260584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2022-04-23 04:15:49.260601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2022-04-23 04:15:49.260612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-04-23 04:15:49.260625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-04-23 04:15:49.260638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2022-04-23 04:15:49.260649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2022-04-23 04:15:49.260661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2022-04-23 04:15:49.260718: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-04-23 04:15:49.262763: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-04-23 04:15:49.264682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2022-04-23 04:15:49.264724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2022-04-23 04:15:50.013763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-04-23 04:15:50.013858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2022-04-23 04:15:50.013889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2022-04-23 04:15:50.015111: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-04-23 04:15:50.016472: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-04-23 04:15:50.017711: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-04-23 04:15:50.018927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 30130 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-32GB, pci bus id: 0000:13:00.0, compute capability: 7.0)
2022-04-23 04:15:50.019333: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
Model: "model"
________________________________________________________________________________________________________________________
Layer (type)                           Output Shape               Param #       Connected to                            
========================================================================================================================
input (InputLayer)                     [(None, 640, 640, 1)]      0                                                     
________________________________________________________________________________________________________________________
conv2d (Conv2D)                        (None, 640, 640, 32)       320           input[0][0]                             
________________________________________________________________________________________________________________________
leaky_re_lu (LeakyReLU)                (None, 640, 640, 32)       0             conv2d[0][0]                            
________________________________________________________________________________________________________________________
dropout (Dropout)                      (None, 640, 640, 32)       0             leaky_re_lu[0][0]                       
________________________________________________________________________________________________________________________
conv2d_1 (Conv2D)                      (None, 640, 640, 32)       9248          dropout[0][0]                           
________________________________________________________________________________________________________________________
leaky_re_lu_1 (LeakyReLU)              (None, 640, 640, 32)       0             conv2d_1[0][0]                          
________________________________________________________________________________________________________________________
dropout_1 (Dropout)                    (None, 640, 640, 32)       0             leaky_re_lu_1[0][0]                     
________________________________________________________________________________________________________________________
conv2d_2 (Conv2D)                      (None, 320, 320, 32)       9248          dropout_1[0][0]                         
________________________________________________________________________________________________________________________
leaky_re_lu_2 (LeakyReLU)              (None, 320, 320, 32)       0             conv2d_2[0][0]                          
________________________________________________________________________________________________________________________
dropout_2 (Dropout)                    (None, 320, 320, 32)       0             leaky_re_lu_2[0][0]                     
________________________________________________________________________________________________________________________
conv2d_3 (Conv2D)                      (None, 320, 320, 64)       18496         dropout_2[0][0]                         
________________________________________________________________________________________________________________________
leaky_re_lu_3 (LeakyReLU)              (None, 320, 320, 64)       0             conv2d_3[0][0]                          
________________________________________________________________________________________________________________________
dropout_3 (Dropout)                    (None, 320, 320, 64)       0             leaky_re_lu_3[0][0]                     
________________________________________________________________________________________________________________________
conv2d_4 (Conv2D)                      (None, 320, 320, 64)       36928         dropout_3[0][0]                         
________________________________________________________________________________________________________________________
leaky_re_lu_4 (LeakyReLU)              (None, 320, 320, 64)       0             conv2d_4[0][0]                          
________________________________________________________________________________________________________________________
dropout_4 (Dropout)                    (None, 320, 320, 64)       0             leaky_re_lu_4[0][0]                     
________________________________________________________________________________________________________________________
conv2d_5 (Conv2D)                      (None, 160, 160, 64)       36928         dropout_4[0][0]                         
________________________________________________________________________________________________________________________
leaky_re_lu_5 (LeakyReLU)              (None, 160, 160, 64)       0             conv2d_5[0][0]                          
________________________________________________________________________________________________________________________
dropout_5 (Dropout)                    (None, 160, 160, 64)       0             leaky_re_lu_5[0][0]                     
________________________________________________________________________________________________________________________
conv2d_6 (Conv2D)                      (None, 160, 160, 128)      73856         dropout_5[0][0]                         
________________________________________________________________________________________________________________________
leaky_re_lu_6 (LeakyReLU)              (None, 160, 160, 128)      0             conv2d_6[0][0]                          
________________________________________________________________________________________________________________________
dropout_6 (Dropout)                    (None, 160, 160, 128)      0             leaky_re_lu_6[0][0]                     
________________________________________________________________________________________________________________________
conv2d_7 (Conv2D)                      (None, 160, 160, 128)      147584        dropout_6[0][0]                         
________________________________________________________________________________________________________________________
leaky_re_lu_7 (LeakyReLU)              (None, 160, 160, 128)      0             conv2d_7[0][0]                          
________________________________________________________________________________________________________________________
dropout_7 (Dropout)                    (None, 160, 160, 128)      0             leaky_re_lu_7[0][0]                     
________________________________________________________________________________________________________________________
conv2d_8 (Conv2D)                      (None, 80, 80, 128)        147584        dropout_7[0][0]                         
________________________________________________________________________________________________________________________
leaky_re_lu_8 (LeakyReLU)              (None, 80, 80, 128)        0             conv2d_8[0][0]                          
________________________________________________________________________________________________________________________
dropout_8 (Dropout)                    (None, 80, 80, 128)        0             leaky_re_lu_8[0][0]                     
________________________________________________________________________________________________________________________
conv2d_9 (Conv2D)                      (None, 80, 80, 256)        295168        dropout_8[0][0]                         
________________________________________________________________________________________________________________________
leaky_re_lu_9 (LeakyReLU)              (None, 80, 80, 256)        0             conv2d_9[0][0]                          
________________________________________________________________________________________________________________________
dropout_9 (Dropout)                    (None, 80, 80, 256)        0             leaky_re_lu_9[0][0]                     
________________________________________________________________________________________________________________________
conv2d_10 (Conv2D)                     (None, 80, 80, 256)        590080        dropout_9[0][0]                         
________________________________________________________________________________________________________________________
leaky_re_lu_10 (LeakyReLU)             (None, 80, 80, 256)        0             conv2d_10[0][0]                         
________________________________________________________________________________________________________________________
dropout_10 (Dropout)                   (None, 80, 80, 256)        0             leaky_re_lu_10[0][0]                    
________________________________________________________________________________________________________________________
conv2d_11 (Conv2D)                     (None, 40, 40, 256)        590080        dropout_10[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_11 (LeakyReLU)             (None, 40, 40, 256)        0             conv2d_11[0][0]                         
________________________________________________________________________________________________________________________
dropout_11 (Dropout)                   (None, 40, 40, 256)        0             leaky_re_lu_11[0][0]                    
________________________________________________________________________________________________________________________
conv2d_12 (Conv2D)                     (None, 40, 40, 256)        590080        dropout_11[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_12 (LeakyReLU)             (None, 40, 40, 256)        0             conv2d_12[0][0]                         
________________________________________________________________________________________________________________________
dropout_12 (Dropout)                   (None, 40, 40, 256)        0             leaky_re_lu_12[0][0]                    
________________________________________________________________________________________________________________________
conv2d_13 (Conv2D)                     (None, 40, 40, 256)        590080        dropout_12[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_13 (LeakyReLU)             (None, 40, 40, 256)        0             conv2d_13[0][0]                         
________________________________________________________________________________________________________________________
dropout_13 (Dropout)                   (None, 40, 40, 256)        0             leaky_re_lu_13[0][0]                    
________________________________________________________________________________________________________________________
conv2d_transpose (Conv2DTranspose)     (None, 80, 80, 256)        590080        dropout_13[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_14 (LeakyReLU)             (None, 80, 80, 256)        0             conv2d_transpose[0][0]                  
________________________________________________________________________________________________________________________
dropout_14 (Dropout)                   (None, 80, 80, 256)        0             leaky_re_lu_14[0][0]                    
________________________________________________________________________________________________________________________
concatenate (Concatenate)              (None, 80, 80, 512)        0             dropout_14[0][0]                        
                                                                                dropout_10[0][0]                        
________________________________________________________________________________________________________________________
conv2d_14 (Conv2D)                     (None, 80, 80, 256)        1179904       concatenate[0][0]                       
________________________________________________________________________________________________________________________
leaky_re_lu_15 (LeakyReLU)             (None, 80, 80, 256)        0             conv2d_14[0][0]                         
________________________________________________________________________________________________________________________
dropout_15 (Dropout)                   (None, 80, 80, 256)        0             leaky_re_lu_15[0][0]                    
________________________________________________________________________________________________________________________
conv2d_15 (Conv2D)                     (None, 80, 80, 256)        590080        dropout_15[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_16 (LeakyReLU)             (None, 80, 80, 256)        0             conv2d_15[0][0]                         
________________________________________________________________________________________________________________________
dropout_16 (Dropout)                   (None, 80, 80, 256)        0             leaky_re_lu_16[0][0]                    
________________________________________________________________________________________________________________________
conv2d_transpose_1 (Conv2DTranspose)   (None, 160, 160, 128)      295040        dropout_16[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_17 (LeakyReLU)             (None, 160, 160, 128)      0             conv2d_transpose_1[0][0]                
________________________________________________________________________________________________________________________
dropout_17 (Dropout)                   (None, 160, 160, 128)      0             leaky_re_lu_17[0][0]                    
________________________________________________________________________________________________________________________
concatenate_1 (Concatenate)            (None, 160, 160, 256)      0             dropout_17[0][0]                        
                                                                                dropout_7[0][0]                         
________________________________________________________________________________________________________________________
conv2d_16 (Conv2D)                     (None, 160, 160, 128)      295040        concatenate_1[0][0]                     
________________________________________________________________________________________________________________________
leaky_re_lu_18 (LeakyReLU)             (None, 160, 160, 128)      0             conv2d_16[0][0]                         
________________________________________________________________________________________________________________________
dropout_18 (Dropout)                   (None, 160, 160, 128)      0             leaky_re_lu_18[0][0]                    
________________________________________________________________________________________________________________________
conv2d_17 (Conv2D)                     (None, 160, 160, 128)      147584        dropout_18[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_19 (LeakyReLU)             (None, 160, 160, 128)      0             conv2d_17[0][0]                         
________________________________________________________________________________________________________________________
dropout_19 (Dropout)                   (None, 160, 160, 128)      0             leaky_re_lu_19[0][0]                    
________________________________________________________________________________________________________________________
conv2d_transpose_2 (Conv2DTranspose)   (None, 320, 320, 64)       73792         dropout_19[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_20 (LeakyReLU)             (None, 320, 320, 64)       0             conv2d_transpose_2[0][0]                
2022-04-23 04:15:51.387073: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2022-04-23 04:15:51.387152: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2022-04-23 04:15:51.387210: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2022-04-23 04:15:51.388055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so.10.1
2022-04-23 04:15:51.488531: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_INSUFFICIENT_PRIVILEGES
2022-04-23 04:15:51.488583: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
________________________________________________________________________________________________________________________
dropout_20 (Dropout)                   (None, 320, 320, 64)       0             leaky_re_lu_20[0][0]                    
________________________________________________________________________________________________________________________
concatenate_2 (Concatenate)            (None, 320, 320, 128)      0             dropout_20[0][0]                        
                                                                                dropout_4[0][0]                         
________________________________________________________________________________________________________________________
conv2d_18 (Conv2D)                     (None, 320, 320, 64)       73792         concatenate_2[0][0]                     
________________________________________________________________________________________________________________________
leaky_re_lu_21 (LeakyReLU)             (None, 320, 320, 64)       0             conv2d_18[0][0]                         
________________________________________________________________________________________________________________________
dropout_21 (Dropout)                   (None, 320, 320, 64)       0             leaky_re_lu_21[0][0]                    
________________________________________________________________________________________________________________________
conv2d_19 (Conv2D)                     (None, 320, 320, 64)       36928         dropout_21[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_22 (LeakyReLU)             (None, 320, 320, 64)       0             conv2d_19[0][0]                         
________________________________________________________________________________________________________________________
dropout_22 (Dropout)                   (None, 320, 320, 64)       0             leaky_re_lu_22[0][0]                    
________________________________________________________________________________________________________________________
conv2d_transpose_3 (Conv2DTranspose)   (None, 640, 640, 32)       18464         dropout_22[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_23 (LeakyReLU)             (None, 640, 640, 32)       0             conv2d_transpose_3[0][0]                
________________________________________________________________________________________________________________________
dropout_23 (Dropout)                   (None, 640, 640, 32)       0             leaky_re_lu_23[0][0]                    
________________________________________________________________________________________________________________________
concatenate_3 (Concatenate)            (None, 640, 640, 64)       0             dropout_23[0][0]                        
                                                                                dropout_1[0][0]                         
________________________________________________________________________________________________________________________
conv2d_20 (Conv2D)                     (None, 640, 640, 32)       18464         concatenate_3[0][0]                     
________________________________________________________________________________________________________________________
leaky_re_lu_24 (LeakyReLU)             (None, 640, 640, 32)       0             conv2d_20[0][0]                         
________________________________________________________________________________________________________________________
dropout_24 (Dropout)                   (None, 640, 640, 32)       0             leaky_re_lu_24[0][0]                    
________________________________________________________________________________________________________________________
conv2d_21 (Conv2D)                     (None, 640, 640, 32)       9248          dropout_24[0][0]                        
________________________________________________________________________________________________________________________
leaky_re_lu_25 (LeakyReLU)             (None, 640, 640, 32)       0             conv2d_21[0][0]                         
________________________________________________________________________________________________________________________
dropout_25 (Dropout)                   (None, 640, 640, 32)       0             leaky_re_lu_25[0][0]                    
________________________________________________________________________________________________________________________
conv2d_22 (Conv2D)                     (None, 640, 640, 1)        33            dropout_25[0][0]                        
________________________________________________________________________________________________________________________
tf.__operators__.add (TFOpLambda)      (None, 640, 640, 1)        0             input[0][0]                             
                                                                                conv2d_22[0][0]                         
========================================================================================================================
Total params: 6,464,129
Trainable params: 6,464,129
Non-trainable params: 0
________________________________________________________________________________________________________________________
Loading data
Train ['L286', 'L109', 'L096', 'L506', 'L310', 'L192', 'L333']
Valid ['L291', 'L143', 'L067', 'ACR']
